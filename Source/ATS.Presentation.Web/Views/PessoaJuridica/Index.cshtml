@model  ATS.Cadastro.Application.ViewModels.PessoaJuridica.PesquisarPessoaJuridicaViewModel

@{
    ViewBag.Title = "Pessoa Jurídica";
    ViewBag.Pagina = "PessoaJuridica";
}

<div class="nomePagina" pagina="@ViewBag.Pagina"></div>

<!-- Content Header (Page header) -->
<section class="content-header">
    <h1>
        Pessoa Jurídica
        <small>Busca</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="@Url.Action("Index", "Home")"><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active">Pessoa Jurídica</li>
    </ol>
</section>

<!-- Main content -->
<section class="content">
    <div class="row">
        <div class="col-xs-12">
            <div class="box box-warning">
                <div class="box-header with-border">
                    <h3 class="box-title">Pesquisar</h3>
                </div>
                @using (Html.BeginForm("Pesquisar", "PessoaJuridica", FormMethod.Post, new { @id = "formPessoaJuridicaPesquisa", role = "form", @autocomplete = "off" }))
                {
                    @Html.AntiForgeryToken()

                    <div class="box-body">
                        <div class="row">
                            <div class="col-xs-7">
                                @Html.TextBoxFor(m => m.RazaoSocial, new { @class = "form-control", @placeholder = "Razão Social" })
                            </div>
                            <div class="col-xs-5">
                                @Html.TextBoxFor(m => m.CNPJ, new { @class = "form-control cnpj", @placeholder = "CNPJ" })
                            </div>
                        </div>
                    </div>
                    <!-- /.box-body -->
                    <div class="box-footer">
                        <div class="pull-right">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fa fa-save"></i>&nbsp;
                                Pesquisar
                            </button>
                        </div>
                    </div>
                }
            </div>
            <!-- /.box -->

            <div class="box box-warning">
                <div class="box-header">
                    <h3 class="box-title">Resultado</h3>
                    <div class="box-tools pull-right">
                        <a href="@Url.Action("Cadastrar", "PessoaJuridica")" class="btn btn-primary btn-lg">
                            <i class="fa fa-plus"></i> &nbsp; Cadastrar Novo
                        </a>
                    </div>
                </div>
                <!-- /.box-header -->
                <div class="box-body">
                    <table id="example2" class="table table-striped table-hover datatable">
                        <thead>
                            <tr>
                                <th>Razão Social</th>
                                <th>CNPJ</th>
                                <th>Inscrição</th>
                                <th>Socio Principal</th>
                                <th>#</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (Model.ListaDePessoasJuridicas != null && Model.ListaDePessoasJuridicas.Any())
                            {
                                foreach (var pessoaJuridica in Model.ListaDePessoasJuridicas)
                                {
                                    <tr>
                                        <td>@pessoaJuridica.RazaoSocial</td>
                                        <td class="cnpj">@pessoaJuridica.CNPJ</td>
                                        <td>
                                            @if (!string.IsNullOrEmpty(pessoaJuridica.Inscricao))
                                            {
                                                @pessoaJuridica.Inscricao
                                            }
                                            else
                                            {
                                                @:-
                                            }
                                        </td>
                                        <td>
                                            @if (pessoaJuridica.Socio != null)
                                            {
                                                @pessoaJuridica.Socio.Nome
                                            }
                                            else
                                            {
                                                @:-
                                            }
                                        </td>
                                        <td style="width: 120px; text-align: center">
                                            <a href="@Url.Action("Editar", "PessoaJuridica", new { id = pessoaJuridica.IdPessoa.Value })" class="btn btn-warning btn-sm btnEditar" data-toggle="tooltip" title="Editar">
                                                <i class="fa fa-edit"></i>
                                            </a>
                                            <a href="javascript:void(0);" class="btn btn-danger btn-sm btnExcluir" tabindex="0" data-toggle="tooltip" title="Excluir" id="@pessoaJuridica.IdPessoa.Value">
                                                <i class="fa fa-trash"></i>
                                            </a>
                                        </td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
                <!-- /.box-body -->
            </div>
            <!-- /.box -->
        </div>
        <!-- /.col -->
    </div>
    <!-- /.row -->
</section>
<!-- /.content -->

@{ Html.RenderPartial("~/Views/Shared/_PopoverDeExclusao.cshtml"); }

@section Styles
{
    <!-- DataTables -->
    <link href="~/Content/plugins/datatables/dataTables.bootstrap.css" rel="stylesheet" />
}

@section Scripts
{
    <!-- DataTables -->
    <script type="text/javascript" src="~/Content/plugins/datatables/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="~/Content/plugins/datatables/dataTables.bootstrap.min.js"></script>

    <!-- Jquery Mask -->
    <script type="text/javascript" src="~/Content/plugins/jquery-mask/jquery.mask.min.js"></script>

    <script src="~/Content/custom/js/ExcluirPopoverTooltipCustom.js"></script>

    <script type="text/javascript">
        $(document).ready(function ()
        {
            $('.datatable').DataTable({
              "paging": true,
              "lengthChange": false,
              "searching": false,
              "ordering": true,
              "info": true,
              "autoWidth": false,
              "pageLength": 20,
              "responsive": true,
              "language": {
                  "sEmptyTable": "Nenhum registro encontrado",
                  "sInfo": "Mostrando de _START_ até _END_ de _TOTAL_ registros",
                  "sInfoEmpty": "Mostrando 0 até 0 de 0 registros",
                  "sInfoFiltered": "(Filtrados de _MAX_ registros)",
                  "sInfoPostFix": "",
                  "sInfoThousands": ".",
                  "sLengthMenu": "_MENU_ resultados por página",
                  "sLoadingRecords": "Carregando...",
                  "sProcessing": "Processando...",
                  "sZeroRecords": "Nenhum registro encontrado",
                  "sSearch": "Pesquisar",
                  "oPaginate": {
                      "sNext": "Próximo",
                      "sPrevious": "Anterior",
                      "sFirst": "Primeiro",
                      "sLast": "Último"
                  },
                  "oAria": {
                      "sSortAscending": ": Ordenar colunas de forma ascendente",
                      "sSortDescending": ": Ordenar colunas de forma descendente"
                  }
                },
            });

            $('.cnpj').mask('00.000.000/0000-00', { reverse: true });
         });
    </script>
}

